## ---- QUERIES

# Get one specific survey
query survey($id: ID!) {
  survey(id: $id) {
    data {
      ...surveyEntityFragment
    }
  }
}

# Search one survey by its slug (/!\ result is an array)
query surveyBySlug($slug: String!) {
  surveys(filters: { slug: { eq: $slug } }) {
    data {
      ...surveyEntityFragment
    }
  }
}

## ---- MUTATIONS

# Create survey
mutation addSurvey($values: SurveyInput!) {
  createSurvey(data: $values) {
    data {
      id
      attributes {
        title
        slug
      }
    }
  }
}

# Update survey
mutation updateSurvey($id: ID!, $data: SurveyInput!) {
  updateSurvey(id: $id, data: $data) {
    data {
      id
      attributes {
        title
        slug
        need_consent
        landing {
          data {
            id
          }
        }
      }
    }
  }
}

# Delete survey
mutation deleteSurvey($id: ID!) {
  deleteSurvey(id: $id) {
    data {
      id
    }
  }
}

# Update order in survey
mutation updateOrder($id: ID!, $new_order: JSON) {
  updateSurvey(id: $id, data: { order: $new_order }) {
    data {
      id
      attributes {
        order
      }
    }
  }
}

# Get stats of a survey by ID
query getSurveyStats($id: ID!) {
  surveyStats(id: $id) {
    title
    description
    publishedAt
    createdAt
    statistics {
      day {
        visits
        consented
        completed
      }
      week {
        visits
        consented
        completed
      }
      month {
        visits
        consented
        completed
      }
      semester {
        visits
        consented
        completed
      }
      year {
        visits
        consented
        completed
      }
      all {
        visits
        consented
        completed
      }
    }
  }
}

# TODO: Harmonize with the other queries (add data and attributes)
